/**********************************************************************************************************************
 *  FILE DESCRIPTION
 *  -----------------------------------------------------------------------------------------------------------------*/
/**        \file  keypad.c
 *        proogram of keypad and functions 
 *
 *      \details  
 *
 *
 *********************************************************************************************************************/

/**********************************************************************************************************************
 *  INCLUDES
 *********************************************************************************************************************/
#include "keypad.h"
/**********************************************************************************************************************
*  LOCAL MACROS CONSTANT\FUNCTION
*********************************************************************************************************************/


/**********************************************************************************************************************
 *  LOCAL DATA 
 *********************************************************************************************************************/

	
	
extern 	u8 keypad_buttons[COL_NUM][ROW_NUM] ;
extern u8 keypad_row_pin[4] ;
extern u8 keypad_col_pin[4] ;
/**********************************************************************************************************************
 *  GLOBAL DATA
 *********************************************************************************************************************/

/**********************************************************************************************************************
 *  LOCAL FUNCTION PROTOTYPES
 *********************************************************************************************************************/

/**********************************************************************************************************************
 *  LOCAL FUNCTIONS
 *********************************************************************************************************************/

/**********************************************************************************************************************
 *  GLOBAL FUNCTIONS
 *********************************************************************************************************************/


/******************************************************************************
* \Syntax          : void keypad init(void)        
* \Description     : initialization function of keypad pins                                    
*                                                                             
* \Sync\Async      : Synchronous                                               
* \Reentrancy      : Non Reentrant                                             
* \Parameters (in) : parameterName   Parameter Describtion                                                                         
* \Return value:   : Std_ReturnType  E_OK
*                                    E_NOT_OK                                  
*******************************************************************************/
void keypad_init(void) 
{   for (u8 count=0 ; count<ROW_NUM ; count++)
	{	
		dio_vidConfigChannel(ROW_PORT,keypad_row_pin[count],OUTPUT);
		dio_vidWriteChannel(ROW_PORT,keypad_row_pin[count],STD_HIGH) ;
	}		

	for (u8 count=0 ; count<COL_NUM ; count++)
	{	
		dio_vidConfigChannel(COLUMN_PORT,keypad_col_pin[count],INPUT);
		dio_vidEnablePullUp(COLUMN_PORT,keypad_col_pin[count]);
	}		
	
}

/****************************************************************/
/* Description    :  This function used to read value of pressed button of keypad  */
/*					 Inputs : void			 					*/
/*					 return : void		 						*/
/****************************************************************/
u8 keypad_get_states(void)
{
	u8 rcount = 0 ;
	u8 result = 0 ;
	for(rcount= 0 ;rcount<ROW_NUM;rcount++)
	{
			dio_vidWriteChannel(ROW_PORT,keypad_row_pin[rcount],STD_LOW) ;
			u8 ccount = 0 ;
			for(ccount =0 ;ccount<COL_NUM;ccount++)
			{  
				 if(dio_dioLevelReadChannel(COLUMN_PORT,keypad_col_pin[ccount])==STD_LOW)
				{
							result = keypad_buttons[rcount][ccount] ;
							 while(dio_dioLevelReadChannel(COLUMN_PORT,keypad_col_pin[ccount])==STD_LOW) ;
							_delay_ms(10);
				}
			}
			dio_vidWriteChannel(ROW_PORT,keypad_row_pin[rcount],STD_HIGH) ;
	}
	return result ; 
	
}
/**********************************************************************************************************************
 *  END OF FILE: FileName.c
 *********************************************************************************************************************/
